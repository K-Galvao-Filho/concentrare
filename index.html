<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Um temporizador Pomodoro completo com lista de tarefas, relatórios e temas para ajudar você a focar e aumentar sua produtividade.">
    <title>CONCENTRARE</title>
    
    <link id="favicon" rel="icon" href="data:image/svg+xml,...">
    
    <link rel="stylesheet" href="css/bootstrap.min.css">
    <link rel="stylesheet" href="css/bootstrap-icons.min.css">
    <link rel="stylesheet" href="css/fonts.css">
    <link rel="stylesheet" href="css/style.css">

    <link rel="manifest" href="manifest.json">
    <meta name="theme-color" content="#79A37D">
</head>
<body>
    <div id="announcer" class="visually-hidden" aria-live="polite" aria-atomic="true"></div>

    <header class="app-header">
        <h1 class="app-title">CONCENTRARE</h1>
        <div class="header-controls">
            <button class="icon-btn" id="theme-toggle-btn" aria-label="Alternar tema claro e escuro"><i class="bi bi-moon-stars-fill"></i></button>
            <button class="icon-btn" data-bs-toggle="modal" data-bs-target="#statsModal" aria-label="Abrir relatórios e estatísticas"><i class="bi bi-bar-chart-line"></i></button>
            <button class="icon-btn" data-bs-toggle="modal" data-bs-target="#settingsModal" aria-label="Abrir configurações"><i class="bi bi-gear"></i></button>
        </div>
    </header>

    <div class="content-wrapper">
        <main id="pomodoro-container" class="widget">
            <div id="mode-buttons" class="mode-buttons-container">
                <button class="mode-btn active" data-mode="pomodoro">Pomodoro</button>
                <button class="mode-btn" data-mode="shortBreak">Pausa Curta</button>
                <button class="mode-btn" data-mode="longBreak">Pausa Longa</button>
            </div>
            <div class="timer-container">
                <svg class="progress-ring" width="220" height="220">
                    <circle class="progress-ring-bg" stroke-width="8" cx="110" cy="110" r="100" />
                    <circle class="progress-ring-fg" stroke-width="8" cx="110" cy="110" r="100" />
                </svg>
                <div id="timer-display" class="timer-display">25:00</div>
            </div>
            <div id="control-buttons" class="control-buttons-container">
                <button id="start-btn" class="control-btn start-btn"><i class="bi bi-play-fill"></i> INICIAR</button>
                <button id="pause-btn" class="control-btn pause-btn hidden" aria-label="Pausar"><i class="bi bi-pause-fill"></i></button>
                <button id="stop-btn" class="control-btn stop-btn hidden" aria-label="Parar"><i class="bi bi-stop-fill"></i></button>
                <button id="next-btn" class="control-btn next-btn hidden" aria-label="Próxima Fase"><i class="bi bi-skip-end-fill"></i></button>
            </div>
            
            <div class="ambient-sound-control">
                <i class="bi bi-music-note-beamed"></i>
                <select id="ambient-sound-select-main" class="form-select form-select-sm">
                    <option value="none">Nenhum Som</option>
                    <optgroup label="YouTube">
                        <option value="youtube_jfKfPfyJRdk">Lofi Girl Radio</option>
                        <option value="youtube_4xDzrJKXOOY">Synthwave Radio</option>
                        <option value="youtube_SExT7KAO1Hg">Purple Cat</option>
                    </optgroup>
                    <optgroup label="Sons de Ambiente">
                        <option value="tick-tock">Tic Tac</option>
                        <option value="gentle-rain">Chuva Suave</option>
                        <option value="heavy-rain">Chuva Pesada</option>
                        <option value="night-forest">Floresta Noturna</option>
                        <option value="library">Biblioteca</option>
                        <option value="beach">Praia</option>
                        <option value="brown-noise">Ruído Marrom</option>
                        <option value="lo-fi">Lo-Fi</option>
                    </optgroup>
                </select>
            </div>
            
            <div id="youtube-player-container" class="hidden">
                <div id="youtube-player"></div>
            </div>
            
            <div class="counters-container">
                <span id="pomodoro-counter">Pomodoro: 0 / 4</span>
                <span id="cycle-counter">Ciclo: 1 / 1</span>
            </div>
        </main>

        <section class="widget task-container">
            <div class="task-header">
                <h3>Tarefas</h3>
                <span id="task-summary">0 / 0</span>
                <button id="clear-completed-btn" class="clear-btn" title="Limpar tarefas concluídas">
                    <i class="bi bi-trash"></i> Limpar Concluídas
                </button>
            </div>
            <ul id="task-list" class="task-list"></ul>
            <form id="task-form" class="task-form">
                <div class="form-group task-input-group">
                    <label for="task-input">O que você está focando?</label>
                    <input type="text" id="task-input" placeholder="Ex: Criar novo layout" autocomplete="off">
                </div>
                <div class="form-group">
                    <label for="task-pomodoro-estimate">Pomodoros</label>
                    <input type="number" id="task-pomodoro-estimate" min="1" max="10" value="1" title="Estimativa de Pomodoros">
                </div>
                <button type="submit" aria-label="Adicionar Tarefa"><i class="bi bi-plus-lg"></i></button>
            </form>
        </section>
    </div>

    <div class="modal fade" id="statsModal" tabindex="-1" aria-labelledby="statsModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="statsModalLabel">Relatórios</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <p>Pomodoros concluídos hoje: <strong id="stats-today">0</strong></p>
                    <p>Total de pomodoros concluídos: <strong id="stats-total">0</strong></p>
                </div>
            </div>
        </div>
    </div>

    <div class="modal fade" id="settingsModal" tabindex="-1" aria-labelledby="settingsModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="settingsModalLabel">Configurações</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <div class="row">
                        <div class="col-md-6">
                            <h6><i class="bi bi-clock-history"></i> Duração (minutos)</h6>
                            <div class="mb-3">
                                <label for="pomodoro-time" class="form-label">Pomodoro</label>
                                <input type="number" class="form-control" id="pomodoro-time" value="25">
                            </div>
                            <div class="mb-3">
                                <label for="short-break-time" class="form-label">Pausa Curta</label>
                                <input type="number" class="form-control" id="short-break-time" value="5">
                            </div>
                            <div class="mb-3">
                                <label for="long-break-time" class="form-label">Pausa Longa</label>
                                <input type="number" class="form-control" id="long-break-time" value="15">
                            </div>
                            <hr>
                            <h6><i class="bi bi-arrow-repeat"></i> Ciclos</h6>
                            <div class="mb-3">
                                <label for="pomodoros-per-cycle" class="form-label">Pomodoros por Ciclo</label>
                                <input type="number" class="form-control" id="pomodoros-per-cycle" value="4">
                            </div>
                             <div class="mb-3">
                                <label for="total-cycles" class="form-label">Total de Ciclos (Modo Padrão)</label>
                                <input type="number" class="form-control" id="total-cycles" value="1">
                            </div>
                        </div>
                        <div class="col-md-6">
                            <h6><i class="bi bi-sliders"></i> Comportamento e Automação</h6>
                            <div class="form-check form-switch mb-2">
                                <input class="form-check-input" type="checkbox" role="switch" id="auto-start-breaks-switch">
                                <label class="form-check-label" for="auto-start-breaks-switch">Iniciar pausas automaticamente</label>
                            </div>
                            <div class="form-check form-switch mb-3">
                                <input class="form-check-input" type="checkbox" role="switch" id="auto-start-pomodoros-switch">
                                <label class="form-check-label" for="auto-start-pomodoros-switch">Iniciar pomodoros automaticamente</label>
                            </div>
                             <div class="form-check form-switch mb-3">
                                <input class="form-check-input" type="checkbox" role="switch" id="strict-task-mode-switch">
                                <label class="form-check-label" for="strict-task-mode-switch">Exigir tarefa ativa para iniciar</label>
                            </div>
                            <div class="mb-3">
                                <label for="on-task-completed-action-select" class="form-label">Ao concluir uma tarefa:</label>
                                <select id="on-task-completed-action-select" class="form-select">
                                    <option value="ask">Perguntar o que fazer</option>
                                    <option value="startNext">Iniciar próxima tarefa</option>
                                    <option value="revertToStandard">Voltar ao modo padrão</option>
                                </select>
                            </div>
                            <hr>
                            <h6><i class="bi bi-volume-up"></i> Áudio e Notificações</h6>
                             <div class="form-check form-switch mb-3">
                                <input class="form-check-input" type="checkbox" role="switch" id="browser-notifications-switch" checked>
                                <label class="form-check-label" for="browser-notifications-switch">Ativar notificações do navegador</label>
                            </div>
                            <div class="mb-3">
                                <label for="alarm-sound-select" class="form-label">Som do Alarme</label>
                                <select id="alarm-sound-select" class="form-select">
                                    <option value="none">Silencioso</option>
                                    <option value="notification">Notificação</option>
                                    <option value="digital">Digital</option>
                                    <option value="bell">Sino</option>
                                </select>
                            </div>
                             <div class="mb-3">
                                <label for="alarm-volume-slider" class="form-label">Volume do Alarme</label>
                                <input type="range" class="form-range" id="alarm-volume-slider" min="0" max="1" step="0.1" value="1">
                            </div>
                             <div class="mb-3">
                                <label for="ambient-volume-slider" class="form-label">Volume do Som Ambiente</label>
                                <input type="range" class="form-range" id="ambient-volume-slider" min="0" max="1" step="0.1" value="0.5">
                            </div>
                             <div class="form-check form-switch mb-2">
                                <input class="form-check-input" type="checkbox" role="switch" id="ticking-sound-switch">
                                <label class="form-check-label" for="ticking-sound-switch">Ativar som de tic-tac durante o foco</label>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Fechar</button>
                    <button type="button" class="btn btn-primary" id="save-settings-btn">Salvar</button>
                </div>
            </div>
        </div>
    </div>

    <div class="modal fade" id="taskCompletedModal" tabindex="-1" aria-labelledby="taskCompletedModalLabel" aria-hidden="true" data-bs-backdrop="static" data-bs-keyboard="false">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="taskCompletedModalLabel">Tarefa Concluída!</h5>
                </div>
                <div class="modal-body">
                    <p>Ótimo trabalho! Você completou a tarefa "<strong id="completed-task-name">Nome da Tarefa</strong>".</p>
                    <p>O que você gostaria de fazer a seguir, após sua pausa?</p>
                </div>
                <div class="modal-footer justify-content-center">
                    <button type="button" class="btn btn-primary" id="start-next-task-btn">Iniciar Próxima Tarefa</button>
                    <button type="button" class="btn btn-secondary" id="return-to-standard-btn">Continuar em Modo Padrão</button>
                </div>
            </div>
        </div>
    </div>

    <div class="modal fade" id="restartTaskModal" tabindex="-1" aria-labelledby="restartTaskModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="restartTaskModalLabel">Reiniciar Tarefa?</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <p>Esta tarefa já está marcada como concluída. Deseja zerar seu progresso e iniciá-la novamente?</p>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancelar</button>
                    <button type="button" class="btn btn-primary" id="confirm-restart-btn">Sim, Reiniciar</button>
                </div>
            </div>
        </div>
    </div>
    
    <audio id="notification" src="assets/sounds/notification.mp3" preload="auto"></audio>
    <audio id="digital" src="assets/sounds/digital.mp3" preload="auto"></audio>
    <audio id="bell" src="assets/sounds/bell.mp3" preload="auto"></audio>
    <audio id="ticking-sound" src="assets/sounds/tick-tock.mp3" loop preload="auto"></audio>

    <script>
        function onYouTubeIframeAPIReady() {
            import('./js/audio.js').then(audioModule => {
                audioModule.initializeYouTubeAPI();
            });
        }
    </script>
    <script src="https://www.youtube.com/iframe_api"></script>
    <script src="js/bootstrap.bundle.min.js" defer></script>
    <script type="module" src="js/main.js" defer></script>
</body>
</html>